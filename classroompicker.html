<!DOCTYPE html>
<html>
<head>
    <title>Mr. Lynch's Interactive Slides</title>
    <!-- We only need ONE script: the Google API library -->
    <script async defer src="https://apis.google.com/js/api.js" onload="gapiLoaded()"></script>
    
    <style>
        /* (Your full CSS here) */
        body { background-color: black; color: white; font-family: sans-serif; text-align: center; }
        .main-container { display: none; /* Hidden by default */ flex-direction: row; gap: 20px; width: 95%; margin: 20px auto; text-align: left; }
        .slides-column { flex: 2; }
        .interactive-column { flex: 1; text-align: center; }
        .slide-nav { margin-top: 10px; text-align: center; }
        .slide-nav button { font-size: 16px; padding: 5px 10px; cursor: pointer; }
        .slide-nav span { margin: 0 15px; font-size: 1.2em; }
        .header { text-align: center; color: yellow; }
        #slide-loader p { font-size: 1.5em; color: #888; }
        #signin-button, #signout-button { font-size: 18px; padding: 12px 24px; cursor: pointer; }
        #signout-button { display: none; } /* Hidden by default */
    </style>
</head>
<body>
    <h1 class="header">Mr. Lynch's Interactive Slides</h1>

    <div id="auth-container">
        <div id="signInPrompt">
            <h2>Please sign in to load the slides.</h2>
            <button id="signin-button">Sign In with Google</button>
        </div>
        <button id="signout-button">Sign Out</button>
    </div>
    
    <div class="main-container">
        <div class="slides-column">
            <div id="slide-loader"><p>Loading Slide...</p></div>
            <img id="slide-image" src="" alt="Current Slide" style="width:100%; border: 1px solid grey; display: none;">
            <div class="slide-nav">
                <button onclick="prevSlide()">Previous</button>
                <span id="slide-counter"></span>
                <button onclick="nextSlide()">Next</button>
            </div>
        </div>
        <div class="interactive-column">
            <p id="prompt">Enter your answer for the current slide:</p>
            <input id="inputbox" type="textbox" placeholder="Your answer here...">
            <br>
            <input id="btn" type="button" value="Check My Answer!" onclick="myfunction()">
            <p id="result"></p>
        </div>
    </div>

<script>
    // ========================================================================
    // CONFIGURATION
    // ========================================================================
    const CLIENT_ID = "1032478689007-9gk70vsn7i58l6f0qn5sr8q78sne1al5.apps.googleusercontent.com";
    const PRESENTATION_ID = "1LYl6PebqTv-KQ9aj3-lnvcZwcV_MXbn1hxVUtdG4sFo";
    const SLIDE_IDS = ["g22b68d540b9_0_0", "g11f6b98ef49_0_0", "g11f6b98ef49_0_5"];
    const SCOPES = "https://www.googleapis.com/auth/presentations.readonly";
    // ========================================================================

    let currentSlideIndex = 0;
    let authInstance;

    function gapiLoaded() {
        gapi.load('client:auth2', initClient);
    }

    function initClient() {
        gapi.client.init({
            clientId: CLIENT_ID,
            scope: SCOPES,
            discoveryDocs: ['https://slides.googleapis.com/$discovery/rest?version=v1'],
        }).then(function () {
            authInstance = gapi.auth2.getAuthInstance();
            // Listen for sign-in state changes.
            authInstance.isSignedIn.listen(updateSigninStatus);
            // Handle the initial sign-in state.
            updateSigninStatus(authInstance.isSignedIn.get());
            
            // Set up the button click handlers
            document.getElementById('signin-button').onclick = () => authInstance.signIn();
            document.getElementById('signout-button').onclick = () => authInstance.signOut();

        }, function(error) {
            console.error('Error initializing client:', JSON.stringify(error, null, 2));
            alert("Error initializing Google Client. Check console for details.");
        });
    }

    function updateSigninStatus(isSignedIn) {
        if (isSignedIn) {
            document.getElementById('signInPrompt').style.display = 'none';
            document.getElementById('signout-button').style.display = 'inline-block';
            document.querySelector('.main-container').style.display = 'flex';
            updateSlideDisplay();
        } else {
            document.getElementById('signInPrompt').style.display = 'block';
            document.getElementById('signout-button').style.display = 'none';
            document.querySelector('.main-container').style.display = 'none';
        }
    }

    function updateSlideDisplay() {
        const slideId = SLIDE_IDS[currentSlideIndex];
        const slideImageElement = document.getElementById('slide-image');
        const slideCounterElement = document.getElementById('slide-counter');

        document.getElementById('slide-loader').style.display = 'block';
        slideImageElement.style.display = 'none';

        gapi.client.slides.presentations.pages.getThumbnail({
            presentationId: PRESENTATION_ID,
            pageObjectId: slideId
        }).then(function(response) {
            document.getElementById('slide-loader').style.display = 'none';
            slideImageElement.style.display = 'block';
            
            slideImageElement.src = response.result.contentUrl;
            slideCounterElement.innerHTML = `Slide ${currentSlideIndex + 1} of ${SLIDE_IDS.length}`;
        }, function(error) {
            console.error("API Error:", error);
            slideCounterElement.innerHTML = `Error: ${error.result.error.message || 'Could not load slide'}`;
        });
    }

    // --- Navigation and other functions ---
    function nextSlide() { if (currentSlideIndex < SLIDE_IDS.length - 1) { currentSlideIndex++; updateSlideDisplay(); } }
    function prevSlide() { if (currentSlideIndex > 0) { currentSlideIndex--; updateSlideDisplay(); } }
    function myfunction() { alert("Check Answer button clicked!"); }
    
</script>
</body>
</html>
