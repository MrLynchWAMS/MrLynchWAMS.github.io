<!DOCTYPE html>
<html>
<head>
    <style>
        /* (All your CSS from the previous step) */
        .slide-nav { margin-top: 10px; }
        .slide-nav button { font-size: 16px; padding: 5px 10px; }
        .slide-nav span { margin: 0 15px; font-size: 1.2em; }
    </style>
</head>
<body>
    <h1 class="header">Mr. Lynch's Interactive Slides</h1>

    <div class="main-container">
        <div class="slides-column">
            <img id="slide-image" src="" alt="Loading Slide..." style="width:100%; border: 1px solid grey;">
            <div class="slide-nav">
                <button onclick="prevSlide()">Previous</button>
                <span id="slide-counter"></span>
                <button onclick="nextSlide()">Next</button>
            </div>
        </div>

        <div class="interactive-column">
            </div>
    </div>

    <script>
    // ========================================================================
    // JAVASCRIPT CONFIGURATION - PASTE YOUR INFO HERE
    // ========================================================================
    const API_KEY = "AIzaSyCdnRYchqudW2JvpaHCqbxTlNewghrMEJc";
    const PRESENTATION_ID = "1LYl6PebqTv-KQ9aj3-lnvcZwcV_MXbn1hxVUtdG4sFo";

    // List of the unique Slide IDs you copied from the URL
    const slideIds = [
        "g22b68d540b9_0_0", // Slide 1's ID
        "g11f6b98ef49_0_0", // Slide 2's ID
        "g11f6b98ef49_0_5", // Slide 3's ID
        // ... add all your slide IDs here in order
    ];
    // ========================================================================

    let currentSlideIndex = 0;

    // This is the core function that calls the Google API
    function updateSlideDisplay() {
        const slideId = slideIds[currentSlideIndex];
        const slideImageElement = document.getElementById('slide-image');
        const slideCounterElement = document.getElementById('slide-counter');

        // Show a loading message
        slideCounterElement.innerHTML = `Loading Slide ${currentSlideIndex + 1}...`;
        slideImageElement.src = ""; // Clear the old image

        // The URL for the Google Slides API to get a thumbnail
        const apiUrl = `https://slides.googleapis.com/v1/presentations/${PRESENTATION_ID}/pages/${slideId}/thumbnail?key=${API_KEY}`;

        // Fetch the data from Google's servers
        fetch(apiUrl)
            .then(response => response.json())
            .then(data => {
                // The API gives us back a URL for the image
                const imageUrl = data.contentUrl;
                slideImageElement.src = imageUrl; // Set the image source
                slideCounterElement.innerHTML = `Slide ${currentSlide-index + 1} of ${slideIds.length}`;
            })
            .catch(error => {
                console.error("Error fetching slide image:", error);
                slideCounterElement.innerHTML = "Error loading slide.";
            });

        document.getElementById('inputbox').value = "";
        document.getElementById('result').innerHTML = "";
    }

    function nextSlide() {
        if (currentSlideIndex < slideIds.length - 1) {
            currentSlideIndex++;
            updateSlideDisplay();
        }
    }

    function prevSlide() {
        if (currentSlideIndex > 0) {
            currentSlideIndex--;
            updateSlideDisplay();
        }
    }

    // Load the first slide when the page opens
    window.onload = function() {
        if (!API_KEY || API_KEY === "AIzaSyCdnRYchqudW2JvpaHCqbxTlNewghrMEJc") {
            alert("Error: API_KEY is not configured in the script.");
            return;
        }
        updateSlideDisplay();
    };

    // (Your onSignIn, calc, myfunction, showToast, and other functions go here...)

</script>
</body>
</html>
